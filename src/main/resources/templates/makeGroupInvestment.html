<!DOCTYPE html>
<html lang="en"> <!--begin::Head-->

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Khumbu</title><!--begin::Primary Meta Tags-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/source-sans-3@5.0.12/index.css" integrity="sha256-tXJfXfp6Ewt1ilPzLDtQnJV4hclT9XuaZUKyUvmyr+Q=" crossorigin="anonymous"><!--end::Fonts--><!--begin::Third Party Plugin(OverlayScrollbars)-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.3.0/styles/overlayscrollbars.min.css" integrity="sha256-dSokZseQNT08wYEWiz5iLI8QPlKxG+TswNRD8k35cpg=" crossorigin="anonymous"><!--end::Third Party Plugin(OverlayScrollbars)--><!--begin::Third Party Plugin(Bootstrap Icons)-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.min.css" integrity="sha256-Qsx5lrStHZyR9REqhUF8iQt73X06c8LGIUPzpOhwRrI=" crossorigin="anonymous"><!--end::Third Party Plugin(Bootstrap Icons)--><!--begin::Required Plugin(AdminLTE)-->
    <link rel="stylesheet" href="../admin/dist/css/bootstrap-icons/bootstrap-icons.min.css"><!--end::Required Plugin(AdminLTE)--><!-- apexcharts -->
    <link rel="stylesheet" href="../admin/dist/css/adminlte-custom.css"><!--end::Required Plugin(AdminLTE)-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/apexcharts@3.37.1/dist/apexcharts.css" integrity="sha256-4MX+61mt9NVvvuPjUWdUdyfZfxSB1/Rf9WtqRHgG5S0=" crossorigin="anonymous"><!-- jsvectormap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsvectormap@1.5.3/dist/css/jsvectormap.min.css" integrity="sha256-+uGLJmmTKOqBr+2E6KDYs/NRsHxSkONXFHUL0fy2O/4=" crossorigin="anonymous">

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.1.5/angular.min.js"></script>
    <script src="https://angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.6.0.js" type="text/javascript"></script>
    <script src="https://m-e-conroy.github.io/angular-dialog-service/javascripts/dialogs.min.js" type="text/javascript"></script>
</head> <!--end::Head--> <!--begin::Body-->

<body class="layout-fixed sidebar-expand-lg bg-body-tertiary"> <!--begin::App Wrapper-->
    <div class="app-wrapper"> <!--begin::Header-->
        <nav class="app-header navbar navbar-expand bg-body"> <!--begin::Container-->
            <div class="container-fluid"> <!--begin::Start Navbar Links-->
                <ul class="navbar-nav">
                    <li class="nav-item"> <a class="nav-link" data-lte-toggle="sidebar" href="#" role="button"> <i class="bi bi-list"></i> </a> </li>
                    <li class="nav-item d-none d-md-block"> <a href="../index" class="nav-link"><i class="bi bi-speedometer"></i> Dashboard</a> </li>
                    <li class="nav-item d-none d-md-block"> <a href="../travel" class="nav-link">Travel</a> </li>
                    <li class="nav-item d-none d-md-block"> <a href="../business" class="nav-link">Business</a> </li>
                    <li class="nav-item d-none d-md-block"> <a href="../investment" class="nav-link">Investment</a> </li>

                </ul> <!--end::Start Navbar Links--> <!--begin::End Navbar Links-->
                <ul class="navbar-nav ms-auto"> <!--begin::Navbar Search-->
                    
                    <li class="nav-item dropdown user-menu"> <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"> <img src="../admin/dist/assets/img/userImage.jpg" class="user-image rounded-circle shadow" alt="User Image"> <span class="d-none d-md-inline">user</span> </a>
                  
                        <ul class="dropdown-menu dropdown-menu-lg dropdown-menu-end"> <!--begin::User Image-->
                            <li class="user-header text-bg-primary"> <img src="../admin/dist/assets/img/user1-128x128.jpg" class="rounded-circle shadow" alt="User Image">
                                <p>
                                   user
                                   <small>LoxinPreneur</small>
                                </p>
                            </li> <!--end::User Image--> <!--begin::Menu Body-->
                            <li class="user-body"> <!--begin::Row-->
                                <div class="row">
                                    <div class="col-4 text-center"> <a href="#">Profile</a> </div>
                                    <div class="col-4 text-center"> <a href="#">Friends</a> </div>
                                    <div class="col-4 text-center"> <a href="#">Signout </a> </div>
                                </div> <!--end::Row-->
                            </li> <!--end::Menu Body--> <!--begin::Menu Footer-->
                           </ul>
                        </li>
                    
                    <li class="nav-item"> <a class="nav-link"  href="#" role="button"> <i class="bi bi-gear-fill"></i> Settings </a> </li> <!--end::Navbar Search--> <!--begin::Messages Dropdown Menu-->
                    <li class="nav-item"> <a class="nav-link"  href="#" role="button"> <i class="bi bi-question-circle-fill"></i>  Help </a> </li>
                </ul> <!--end::End Navbar Links-->
            </div> <!--end::Container-->
        </nav> <!--end::Header--> <!--begin::Sidebar-->
    
        <aside class="app-sidebar bg-body-secondary shadow" data-bs-theme="dark"> <!--begin::Sidebar Brand-->
            <div class="sidebar-brand"> <!--begin::Brand Link--> <a href="../index" class="brand-link"> <!--begin::Brand Image--> <img src="../admin/dist/images/logo-white.png"  class="brand-image opacity-95"> <!--end::Brand Image--></a> <!--end::Brand Link--> </div> <!--end::Sidebar Brand--> <!--begin::Sidebar Wrapper-->
            <div class="sidebar-wrapper">
              <nav class="mt-2"> <!--begin::Sidebar Menu-->
                    
                   
                <ul class="nav sidebar-menu flex-column" data-lte-toggle="treeview" role="menu" data-accordion="false">
                    <li class="nav-item"> <a href="#" class="nav-link"> <i class="nav-icon bi bi-calculator-fill"></i>
                        <p>
                           Travel Calculator
                        </p>
                    </a>
                </li> 
                <li class="nav-item"> <a href="#" class="nav-link"> <i class="nav-icon bi bi-clipboard-data-fill"></i>
                <p>
                   System Report
                </p>
                </a>
               </li>
            </ul> 
        </nav>
            </div>
        </aside>
        <main class="app-main"> <!--begin::App Content Header-->
          <div class="app-content-header"> <!--begin::Container-->
                <div class="container-fluid"> <!--begin::Row-->
                    <div class="row">
                      <div class="col-sm-6">
                        <h4 class="mb-0">Available Group Investment</h4>
                      </div>
                        <div class="col-sm-6">
                            <ol class="breadcrumb float-sm-end">
                                <li class="breadcrumb-item"><a href="../index">..</a></li>
                                <li class="breadcrumb-item" aria-current="page">
                                    <a href="../investment">Investment</a>
                                </li>
                                <li class="breadcrumb-item active" aria-current="page">
                                  Available Investment
                              </li>
                            </ol>
                        </div>
                    </div> <!--end::Row-->
                </div> <!--end::Container-->
            </div> <!--end::App Content Header--> <!--begin::App Content-->
            <div class="app-content-header"> <!--begin::Container-->
                <div class="container-fluid"> <!--begin::Row-->
                  
                    <div class="row info-box">
                      <div class="col-sm-12"><a href="javascript:history.back();" title="back" class="text-primary fs-1"><i class="bi bi-chevron-left"></i></a></div> 

                      <div class="col-sm-12">
                        <div class="card mb-4 col-sm-6"> 
                            <!--begin::Header-->
                            <form id="investmentForm" method="post" th:action="@{/group-investments/save}" th:object="${investment}">
                                <div class="card-body">
                                    
                                    <!-- Dropdown to choose an Investment -->
                                    <div class="mb-3">
                                        <label for="investmentId" class="form-label">Select Investment:</label>
                                        <select th:field="*{investment.id}" class="form-select" id="investmentId" required>
                                            <option value="" selected disabled>-- Select an Investment --</option>
                                            <th:block th:each="inv : ${investments}">
                                                <option th:value="${inv.id}" th:text="${inv.name}"></option>
                                            </th:block>
                                        </select>
                                    </div>
                            
                                    <!-- Investment Name (not needed because it's chosen from the dropdown) -->
                                    <div class="mb-3">
                                        <label for="investType" class="form-label">Investment Name:</label>
                                        <select th:field="*{investType}" class="form-select" id="investType" required>
                                            <option value="" selected disabled>-- Select an Investment --</option>
                                            <th:block th:each="inv : ${investments}">
                                                <option th:value="${inv.id}" th:text="${inv.description}"></option>
                                            </th:block>
                                        </select>
                                    </div>
                            
                                    <div class="mb-3">
                                        <label for="investAmount" class="form-label">Investment Amount:</label>
                                        <div class="input-group w-50">
                                            <span class="input-group-text fw-bold" id="inputAmount">R</span>
                                            <input th:field="*{investAmount}" class="form-control" type="number" id="investmentAmount" required>
                                        </div>
                                    </div>
                            
                                    <div class="mb-3">
                                        <label for="remarks" class="form-label">Remarks:</label>
                                        <textarea th:field="*{remarks}" class="form-control" id="remarks"></textarea>
                                    </div>
                            
                                    <div class="mb-3">
                                        <label for="date" class="form-label">Date:</label>
                                        <input th:field="*{date}" class="form-control" type="datetime-local" id="date" required>
                                    </div>
                                </div>
                            
                                <!-- Error message -->
                                <div>
                                    <span id="investmentError" style="color: red;"></span>
                                </div>
                                <!--display amount
                                <p id="displayAmount" class="mt-2 text-success"></p>
                                <p id="displayId" class="mt-2 text-success"></p>
                                -->
                                    <!-- Investment details will be displayed here -->
                                </div>
                                <!-- Submit and Back buttons -->
                                <div>
                                    <button type="submit" class="btn btn-success">Create Investment</button>
                                    <a href="javascript:history.back();" class="btn btn-primary">Back</a>
                                </div>
                            </form> 
                            
                             <!--end::Form-->
                        </div> <!--end::Quick Example--> <!--begin::Input Group-->
                      </div>
                        
                    </div> <!--end::Row-->
                </div> <!--end::Container-->
            </div> <!--end::App Content Header--> <!--begin::App Content-->
            <!-- Success Modal -->
<!-- Success Modal -->
<div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="successModalLabel">Success</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Investment request is successfully created!
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
        </div>
      </div>
    </div>
  </div>
  

              
       </main>
    </div> <!--end::App Wrapper--> <!--begin::Script--> <!--begin::Third Party Plugin(OverlayScrollbars)-->
 <!-- <div id = "loading_indicator"> </div>-->
 <div id="loading_indicator">
    <div class="three-balls">
      <div class="ball ball1"></div>
      <div class="ball ball2"></div>
      <div class="ball ball3"></div>
    </div>
  </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.3.0/browser/overlayscrollbars.browser.es6.min.js" integrity="sha256-H2VM7BKda+v2Z4+DRy69uknwxjyDRhszjXFhsL4gD3w=" crossorigin="anonymous"></script> <!--end::Third Party Plugin(OverlayScrollbars)--><!--begin::Required Plugin(popperjs for Bootstrap 5)-->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha256-whL0tQWoY1Ku1iskqPFvmZ+CHsvmRWx/PIoEvIeWh4I=" crossorigin="anonymous"></script> <!--end::Required Plugin(popperjs for Bootstrap 5)--><!--begin::Required Plugin(Bootstrap 5)-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha256-YMa+wAM6QkVyz999odX7lPRxkoYAan8suedu4k2Zur8=" crossorigin="anonymous"></script> <!--end::Required Plugin(Bootstrap 5)--><!--begin::Required Plugin(AdminLTE)-->
    <script src="../admin/dist/js/adminlte.js"></script> <!--end::Required Plugin(AdminLTE)--><!--begin::OverlayScrollbars Configure-->
    <script src="../admin/dist/js/loading.js"></script>

    <script>
        $(".triprequestform-wrapper").load("add-trip.html");
    </script>
<script>
    // Global variables to store user input
    let myId = "";
    let amount = 0;
    
    // Capture investment amount input
    document.getElementById("investmentAmount").addEventListener("input", function() {
        amount = parseFloat(this.value); // Convert input to a number
        console.log("User entered amount: R" + amount);
        document.getElementById("displayAmount").textContent = "Entered Amount: R" + amount;
    });
    
    // Capture investment ID input
    document.getElementById("investmentId").addEventListener("input", function() {
        myId = parseInt(this.value); // Convert to number
        document.getElementById("displayId").textContent = "ID is: " + myId;
    });
    
    document.getElementById("investmentForm").addEventListener("submit", function(event) {
        event.preventDefault(); 
       
        fetch('/getInvestment')
            .then(response => response.json())
            .then(investmentsData => {
                console.log("Stored Investments:", investmentsData);
    
                let isValidInvestment = false; 
    
                investmentsData.forEach(investment => {
                    if (investment.id === myId) {
                        if (amount < investment.minInvestment || amount > investment.maxInvestment) {
                            alert("Error: Investment amount is out of the allowed range!");
                            isValidInvestment = false;
                        } else {
                            isValidInvestment = true;
                        }
                    }
                });
    
                // If valid, submit form and show modal
                if (isValidInvestment) {
                    fetch(event.target.action, {
                        method: "POST",
                        body: new FormData(event.target)
                    }).then(response => {
                        if (response.ok) {
                            let successModal = new bootstrap.Modal(document.getElementById('successModal'));
                            successModal.show();
    
                            // Clear the form fields
                            document.getElementById("investmentName").value = "";
                            document.getElementById("investType").value = "";
                            document.getElementById("investmentAmount").value = "";
                            document.getElementById("remarks").value = "";
                            document.getElementById("date").value = "";
                        } else {
                            alert("Error saving investment. Please try again.");
                        }
                    }).catch(error => console.error("Error:", error));
                }
            })
            .catch(error => console.error("Error fetching investments:", error));
    });
    </script>

</body>
</html>